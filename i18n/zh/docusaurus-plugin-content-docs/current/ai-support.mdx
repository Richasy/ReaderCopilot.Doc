---
title: AI 支持
---

import copilotAuth from './img/fantasy-copilot-auth.png';
import wordTranslate from "./img/word-translate.png";
import ttsSetting from './img/tts-setting.png';
import pdfCopilot from "./img/pdf-copilot.png";

阅读助理目前提供的 AI 功能都由 [小幻助理](https://www.microsoft.com/store/apps/9NB0NB3MLQTM) 提供。
所以如果你想要在阅读中体验 AI 功能（翻译、朗读、对话），那么前置条件就是安装小幻助理。

## 什么是小幻助理？

[小幻助理](https://www.microsoft.com/store/apps/9NB0NB3MLQTM) 是我开发的一款 AI 应用，它 **免费** 且 **开源**。

- 开源地址：[Richasy/FantasyCopilot](https://github.com/Richasy/FantasyCopilot)

小幻助理支持目前主流的 Open AI 及 Azure Open AI，并且提供了丰富的 AI 集成体验。

:::tip

小幻助理本身不是一种 AI 服务，所使用的各种 AI 功能都需要你自行配置（基本就是填密钥）。

:::

除了提供基本的 AI 体验之外，我还打算将小幻助理变成 AI 核心，阅读助理 和 [哔哩助理](https://www.microsoft.com/store/apps/9MVFJLPH517M) 都是这个计划的一环。

我想打造一套 “助理工具包”，借此探索 AI 应用的开发路径。

## 如何通过小幻助理提供 AI 服务？

:::tip
在连接到小幻助理前，你必须先确保你的设备上安装了 [.NET SDK](https://dotnet.microsoft.com/en-us/download/dotnet/7.0)
:::

阅读助理中所使用的 AI 功能：`翻译`，`朗读` 和 `对话`，在小幻助理中都有对应的功能。

一个简单朴素的道理：

> 如果已经在一个应用中进行了配置，为什么还需要再另一个应用中重新配置一遍？

所以阅读助理会直接读取小幻助理中的配置，并在不启动小幻助理的情况下为用户提供 AI 服务。

换句话说，小幻助理相当于一个额外的配置存储器，阅读助理会在需要的时候读取存储器中配置的密钥信息。

不过本着对用户负责的态度，同时也为了避免这一机制被其他不良应用滥用，我进行了一些限制措施：

1. 阅读助理第一次读取小幻助理配置时需要打开小幻助理进行授权验证。得到授权后，应用才能读取密钥信息。你可以随时在小幻助理的设置页面中取消对某个应用的授权。
   <img src={copilotAuth} height="200px" />

2. 阅读助理只会在当前应用生命周期内持有密钥配置，不会保存密钥信息。应用只有在当前生命周期内第一次调用相关的 AI 功能时才会读取小幻助理的配置信息。

## 关于翻译

在阅读助理中没有提供丰富的翻译语言选项，你只能把文本翻译成当前的应用语言。

绝大多数情况下，阅读时的翻译需求就是 `把不认识的语言文本翻译成我认识的`，而不是 `我想看看这段文本翻译成另一种语言是什么样子`。所以阅读助理提供的翻译选项只为满足 `能看懂` 这一基本需求。

应用提供了划词翻译，这一功能适用于所有文本阅读场景（在线书籍，EPUB，PDF 和 RSS）。

选中文本后右键单击或者长按屏幕，即可弹出文本选择菜单，其中就有文本翻译选项，点击即可翻译。

<img src={wordTranslate} height="200px" />

### 全文翻译

全文翻译功能仅在 RSS 阅读器中提供，这个功能的适用场景其实是在阅读非母语新闻/文章时的快速翻译。

我们知道 RSS 的内容文本是 HTML，翻译 HTML 不可避免要带上一堆标签。这要求翻译服务在翻译的时候不能翻译标签内的内容，否则页面将无法正常显示。

在这个方面，Azure Translator（必应翻译）是做得比较出色的，对网页翻译进行了充分的支持。

反之，百度翻译在这一块就不尽如人意了，在其文档描述中也说了目前不支持网页翻译：

> **如果我需要翻译整个网页，尖括号内的标签无法原样输出，怎么办？**
>
> 翻译API会将传入的所有字符串当做可翻译字符，目前暂时无法区分哪些部分需原样保留，因此 API 不适合直接处理 HTML 文件。您可将 HTML 文件进行译前处理，抽取出待翻译文本，传入 API 翻译后再回填。
>
> <http://api.fanyi.baidu.com/doc/21>

所以目前 RSS 中的全文翻译仅支持 Azure Translator，如果你没有在小幻助理中提供相应的配置，将无法使用全文翻译的功能。

:::tip

老实说，Azure 翻译服务真的挺实惠的，还有每月百万字的免费额度，简直可以说是白嫖了。

:::

## 关于朗读

Windows 本身提供文本转语音（TTS）的 API，可以免费且无限制地使用。缺点也很明显，就是机读味过重，在这种情况下听读简直是一种折磨。

***所以阅读助理没有提供本地 TTS 的支持，语音朗读将调用 Azure 语音服务***

Azure 语音朗读服务提供的 AI 语音效果很不错，我们在短视频中经常听到的 **注意看！这个男人叫小帅！** 就是 Azure 中文的 `云希` 声音。

它还支持如河南话、辽宁话等本地口音，在中文世界，Azure 语音服务是文本转语音的首选。

和翻译类似，阅读助理在所有文本阅读场景中都提供了划词朗读的功能，你可以利用这一功能学习一些单词的发音。

应用为 TTS 提供了一些设置项，你可以在阅读器顶部的设置中调整需要朗读的语言和语音。

<img src={ttsSetting} height="200px" />

### 全文朗读

全文朗读目前仅在在线阅读器中提供，且提供阅读完成自动切换下一章节的功能。

为了能够降低语音生成的等待时间，应用会将文本按照自然段分开，一次只生成两段内容的语音，一段用于播放，一段进行准备。前一段放完，后一段接上，在播放期间生成下一段语音内容。

这样做的好处显而易见，既照顾了用户体验，同时还减少了开支。如果你不想听了，可以随时停止，而不必担心后面的内容浪费（最多浪费一段语音）。

## 关于 AI 对话

随着 ChatGPT 爆火，与之相关联的 AI 应用如雨后春笋般涌出，给传统应用领域注入了新鲜的血液。

受到 ChatPDF 的启发，我也将 ChatGPT 集成进了阅读助理之中，而首选的使用场景就是 PDF 阅读。

鉴于 PDF 使用场景的特殊性，有很多学术论文或者资料会以 PDF 的形式存储（而且通常又长又费解），故而对于 AI 对话索引功能有着更强的需求。

<img src={pdfCopilot} height="600px" />

这个功能基本原理是，将 PDF 内所有文本抽取出来，然后分段转换成向量，然后将你的问题也转换成向量后进行余弦相似比较，找出最匹配的上下文，将上下文与你的问题一起发送给 ChatGPT，最终得到一个严谨的回答。

但是这个功能也有局限性：

1. 相当一部分 PDF 是扫描本，本质上是图片而不是可以选择的文本，这种情况下，除非上 OCR，否则无法被解析。
2. 很多 PDF 没有目录信息，导致难以将查询出的上下文与原有章节对应上，搜出来也不好定位。
3. PDF 中有一部分内容需要借助排版才能更好地理解（比如网格、数据图谱），直接提取文字反而会造成误解。

所以，目前的功能只能做到简单的问答，尚未提供清晰的语义搜索能力。

有鉴于这种种限制，内置的对话功能可能对某些同学并不适用，所以应用也提供了设置项，你可以在设置页面中关闭助理的显示，眼不见心不烦。